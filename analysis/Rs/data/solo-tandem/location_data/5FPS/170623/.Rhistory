truehist(Res$spchange, col=adjustcolor("red",0.5),
xlim=c(-40,40), ylim=c(0,0.15), breaks = seq(-60,60,1))
par(new=T)
truehist(rnorm(10000,0.001247205,4.437163024), col=adjustcolor("blue",0.5),
xlim=c(-40,40), ylim=c(0,0.15))
fitdistr(na.omit(Res$spchange), densfun="cauchy")
truehist(rcauchy(10000,0.339599418, 1.943596361), col=adjustcolor("blue",0.5),
xlim=c(-40,40), ylim=c(0,0.15), breaks=seq(-50000,50000,1))
truehist(rcauchy(10000,0.339599418, 1.943596361), col=adjustcolor("blue",0.5),
xlim=c(-40,40), ylim=c(0,0.15), breaks=seq(-500000,500000,1))
truehist(Res$spchange, col=adjustcolor("red",0.5),
xlim=c(-40,40), ylim=c(0,0.15), breaks = seq(-60,60,1))
par(new=T)
truehist(rnorm(10000,0.001247205,4.437163024), col=adjustcolor("blue",0.5),
xlim=c(-40,40), ylim=c(0,0.15))
par(new=T)
truehist(rcauchy(10000,0.339599418, 1.943596361), col=adjustcolor("blue",0.5),
xlim=c(-40,40), ylim=c(0,0.15), breaks=seq(-50000,50000,1))
truehist(Res$spchange, col=adjustcolor("red",0.5),
xlim=c(-40,40), ylim=c(0,0.15), breaks = seq(-60,60,1))
par(new=T)
truehist(rnorm(10000,0.001247205,4.437163024), col=adjustcolor("blue",0.5),
xlim=c(-40,40), ylim=c(0,0.15))
par(new=T)
truehist(rcauchy(10000,0.339599418, 1.943596361), col=adjustcolor("green",0.5),
xlim=c(-40,40), ylim=c(0,0.15), breaks=seq(-50000,50000,1))
truehist(Res$spchange, col=adjustcolor("red",0.5),
xlim=c(-40,40), ylim=c(0,0.15), breaks = seq(-60,60,1))
par(new=T)
truehist(rnorm(10000,0.001247205,4.437163024), col=adjustcolor("blue",0.5),
xlim=c(-40,40), ylim=c(0,0.15))
par(new=T)
truehist(rcauchy(10000,0.339599418, 1.943596361), col=adjustcolor("green",0.5),
xlim=c(-40,40), ylim=c(0,0.15), breaks=seq(-50000,50000,1))
fitsp <- fitdistr(na.omit(Res$sp), densfun="normal")
fitspdiff <- fitdistr(na.omit(Res$sp), densfun="cauchy")
truehist((Res$sp), col=adjustcolor("red",0.5),
xlim=c(0,60), ylim=c(0,0.15))
par(new=T)
fitsp
truehist(rnorm(10000, 18.94595349, 9.47601641), col=adjustcolor("blue",0.5),
xlim=c(0,60), ylim=c(0,0.15))
par(new=T)
fitspdiff
truehist(rcauchy(10000, 19.41042722, 5.78578139), col=adjustcolor("green",0.5),
xlim=c(0,60), ylim=c(0,0.15), breaks=seq(-50000,50000,1))
angle <- na.omit(Res$angle)
truehist(angle)
mle_wrpcauchy <- wrpcauchy.ml(angle, 0, 0, acc=1e-015)
mle_wrpcauchy
x <- (rwrpcauchy(10000, 0.0029115, 0.8381063))
x[x>pi] <- x[x>pi]-2*pi
truehist(x)
truehist(angle)
par(new=T)
truehist(x)
install.packages("circular")
library(circular)
mle.wrappednormal(angle)
x2 <- rwrappednormal(10000, mu=circular(-0.001341), rho=0.9031, sd=0.4516)
x2[x2>pi] <- x2[x2>pi]-2*pi
install.packages("circular")
truehist(angle, ylim=c(0,2.5), col=adjustcolor("red", 0.5))
par(new=T)
truehist(x, ylim=c(0,2.5), col=adjustcolor("blue", 0.5))
par(new=T)
plot(sp~abs(angle), data=Res)
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(30,15)) +
theme(aspect.ratio = 1)
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_distiller(palette = "Set2", trans = 'log10')
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(palette = "Set2", trans = 'log10')
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
viridis::scale_fill_viridis(palette = "Set2", trans = 'log10')
install.packages("viridis")
library("viridis")
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(palette = "Set2", trans = 'log10')
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')
ggplot(Res, aes(x=sp, y=spchange)) +
stat_bin2d(bins=c(60,60)) +
theme(aspect.ratio = 1)
ggplot(Res, aes(x=sp, y=spchange)) +
stat_bin2d(bins=c(60,60)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')
Res$spchange>0
table(Res$spchange>0)
ggplot(Res, aes(x=sp, y=spchanged)) +
stat_bin2d(bins=c(60,60)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')
Res$sp[1:dim(Res)[1]]
Res$sp[2:dim(Res)[1]-1]
Res$sp[2:dim(Res)[1]]
plot(Res$sp[2:dim(Res)[1]-1], Res$sp[2:dim(Res)[1]])
ggplot(df, aes(x=t1, y=t2))+
stat_bin2d(bins=c(60,60)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')
df <- data.frame(t1 = Res$sp[2:dim(Res)[1]-1], t2 = Res$sp[2:dim(Res)[1]])
ggplot(df, aes(x=t1, y=t2))+
stat_bin2d(bins=c(60,60)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')
ggplot(Res, aes(x=sp, y=spchange)) +
stat_bin2d(bins=c(60,60)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')
setwd("E:\\Dropbox\\research\\with_dropbox\\papers_and_projects\\2017\\Sex movement after separation\\Rs\\solo-tandem\\location_data\\5FPS")
Folder.path <- getwd()
f.namesplace_solo <- list.files(Folder.path, pattern=".txt",full.names=T)
Res<-NULL
for(j in 1:length(f.namesplace_solo)){
data.path <- f.namesplace_solo[j]
d <- read.table(data.path, header=T)
datepoint <- regexpr("170", data.path)[1]+7
id <- (substr(data.path, datepoint, datepoint+14))
date <- (substr(data.path, datepoint, datepoint+5))
if(regexpr("_F_",data.path)>0) { sex <- 0;} else { sex <- 1; }
colony <- (substr(data.path, datepoint+7, datepoint+9))
iter <- (substr(data.path, datepoint+13, datepoint+14))
treat <- (substr(data.path, datepoint+21, datepoint+26))
if(treat=="after-"){treat <- "after"}
if(treat=="after"){
sp <- (d$speed)
angle <- (d$tra_angle)
spchange <- c(diff(sp), NA)
spchanged <- c(NA, diff(sp))
df <- data.frame(sp, spchange, spchanged, angle)
Res <- rbind(Res, df)
}
}
f.namesplace_solo
setwd("E:\\Dropbox\\research\\with_dropbox\\papers_and_projects\\2017\\Sex movement after separation\\Rs\\solo-tandem\\location_data\\5FPS")
Folder.path <- getwd()
Folder.path
setwd("E:\\Dropbox\\research\\with_dropbox\\papers_and_projects\\2017\\Sex movement after separation\\Rs\\solo-tandem\\location_data\\5FPS\\170623")
Folder.path <- getwd()
f.namesplace_solo <- list.files(Folder.path, pattern=".txt",full.names=T)
Res<-NULL
for(j in 1:length(f.namesplace_solo)){
data.path <- f.namesplace_solo[j]
d <- read.table(data.path, header=T)
datepoint <- regexpr("170", data.path)[1]+7
id <- (substr(data.path, datepoint, datepoint+14))
date <- (substr(data.path, datepoint, datepoint+5))
if(regexpr("_F_",data.path)>0) { sex <- 0;} else { sex <- 1; }
colony <- (substr(data.path, datepoint+7, datepoint+9))
iter <- (substr(data.path, datepoint+13, datepoint+14))
treat <- (substr(data.path, datepoint+21, datepoint+26))
if(treat=="after-"){treat <- "after"}
if(treat=="after"){
sp <- (d$speed)
angle <- (d$tra_angle)
spchange <- c(diff(sp), NA)
spchanged <- c(NA, diff(sp))
df <- data.frame(sp, spchange, spchanged, angle)
Res <- rbind(Res, df)
}
}
truehist(Res$sp)
Res
data.path
d <- read.table(data.path, header=T)
datepoint <- regexpr("170", data.path)[1]+7
id <- (substr(data.path, datepoint, datepoint+14))
date <- (substr(data.path, datepoint, datepoint+5))
if(regexpr("_F_",data.path)>0) { sex <- 0;} else { sex <- 1; }
colony <- (substr(data.path, datepoint+7, datepoint+9))
iter <- (substr(data.path, datepoint+13, datepoint+14))
treat <- (substr(data.path, datepoint+21, datepoint+26))
if(treat=="after-"){treat <- "after"}
treat
library(stringr)
str_locate(data.path, "after")
data.path
str_locate(data.path, "before")
str_locate(data.path, "before")[1]
is.na(str_locate(data.path, "before")[1])
!is.na(str_locate(data.path, "before")[1])
Res<-NULL
for(j in 1:length(f.namesplace_solo)){
data.path <- f.namesplace_solo[j]
d <- read.table(data.path, header=T)
if(!is.na(str_locate(data.path, "before")[1])){
if(!is.na(str_locate(data.path, "_M_")[1])){
sp <- (d$speed)
angle <- (d$tra_angle)
spchange <- c(diff(sp), NA)
spchanged <- c(NA, diff(sp))
df <- data.frame(sp, spchange, spchanged, angle)
Res <- rbind(Res, df)
}
}
}
Res
j
d
sp <- (d$speed)
angle <- (d$tra_angle)
spchange <- c(diff(sp), NA)
spchanged <- c(NA, diff(sp))
df <- data.frame(sp, spchange, spchanged, angle)
spchanged
spchange
angle
head(d)
Res<-NULL
for(j in 1:length(f.namesplace_solo)){
data.path <- f.namesplace_solo[j]
d <- read.table(data.path, header=T)
if(!is.na(str_locate(data.path, "before")[1])){
if(!is.na(str_locate(data.path, "_M_")[1])){
sp <- (d$speed)
angle <- (d$angle)
spchange <- c(diff(sp), NA)
spchanged <- c(NA, diff(sp))
df <- data.frame(sp, spchange, spchanged, angle)
Res <- rbind(Res, df)
}
}
}
truehist(Res$sp)
truehist(Res$spchange)
fitdistr(na.omit(Res$spchange), densfun="normal")
fitdistr(na.omit(Res$spchange), densfun="cauchy")
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')
ggplot(Res, aes(x=sp, y=spchange)) +
stat_bin2d(bins=c(60,60)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')
ggplot(Res, aes(x=sp, y=spchanged)) +
stat_bin2d(bins=c(60,60)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')
ggplot(Res, aes(x=sp, y=spchange)) +
stat_bin2d(bins=c(60,60)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')
ggplot(Res, aes(x=sp, y=spchanged)) +
stat_bin2d(bins=c(60,60)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')
df <- data.frame(t1 = Res$sp[2:dim(Res)[1]-1], t2 = Res$sp[2:dim(Res)[1]])
ggplot(df, aes(x=t1, y=t2))+
stat_bin2d(bins=c(60,60)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')
d
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')+
geom_line(data=d, aes(x=abs(angle), y=speed), col="red")
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d, aes(x=abs(angle), y=speed), col="red")
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[1:100,], aes(x=abs(angle), y=speed), col="red")
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[1:5,], aes(x=abs(angle), y=speed), col="red")
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[1:20,], aes(x=abs(angle), y=speed), col="red")
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[1:20,], aes(x=abs(angle), y=speed), col="red")+
geom_point(data=d[20,], aes(x=abs(angle), y=speed), col="red")
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[1:20,], aes(x=abs(angle), y=speed), col="red")+
geom_point(data=d[20,], aes(x=abs(angle), y=speed), col="red", size=2)
dim(d)[1]
formatC(i,width=5,flag="0")
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[(i-19):i,], aes(x=abs(angle), y=speed), col="red")+
geom_point(data=d[i,], aes(x=abs(angle), y=speed), col="red", size=2)
ggsave(paste0(formatC(i,width=5,flag="0"), ".png"))
i
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[(i-19):i,], aes(x=abs(angle), y=speed), col="red")+
geom_point(data=d[i,], aes(x=abs(angle), y=speed), col="red", size=2)
(i-19):i
for(i in 20:dim(d)[1]){
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[(i-19):i,], aes(x=abs(angle), y=speed), col="red")+
geom_point(data=d[i,], aes(x=abs(angle), y=speed), col="red", size=2)
ggsave(paste0("E\\",formatC(i,width=5,flag="0"), ".png"))
}
ggsave(paste0("E\\",formatC(i,width=5,flag="0"), ".png"))
paste0("E\\",formatC(i,width=5,flag="0"), ".png")
for(i in 20:dim(d)[1]){
ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[(i-19):i,], aes(x=abs(angle), y=speed), col="red")+
geom_point(data=d[i,], aes(x=abs(angle), y=speed), col="red", size=2)
ggsave(paste0("E:\\",formatC(i,width=5,flag="0"), ".png"))
}
ggplot(d[(i-19):i,], aes(x=x, y=y)) + geom_path(col="red")
dat <- circleFun(c(1,-1),2.3,npoints = 100)
circleFun <- function(center = c(0,0),diameter = 1, npoints = 100){
r = diameter / 2
tt <- seq(0,2*pi,length.out = npoints)
xx <- center[1] + r * cos(tt)
yy <- center[2] + r * sin(tt)
return(data.frame(x = xx, y = yy))
}
dat <- circleFun(c(1,-1),2.3,npoints = 100)
ggplot(dat,aes(x,y)) + geom_path()
dat
plot(y~x, data=d)
max(d$x)
max(d$y)
min(d$y)
dat <- circleFun(c(64,64),128,npoints = 100)
ggplot(dat,aes(x,y)) + geom_path()
ggplot(d[(i-19):i,], aes(x=x, y=y)) + geom_path(col="red") +
geom_path(data=dat, aes(x,y))
ggplot(d[(i-19):i,], aes(x=x, y=y)) + geom_path(col="red") +
geom_path(data=dat, aes(x,y)) +
ylim(c(0,129)) + xlim(c(0,129))
ggplot(d[(i-19):i,], aes(x=x, y=y)) + geom_path(col="red") +
geom_path(data=dat, aes(x,y)) +
ylim(c(0,129)) + xlim(c(0,129)) +
theme(aspect.ratio = 1)
p1 <- ggplot(d[(i-19):i,], aes(x=x, y=y)) + geom_path(col="red") +
geom_path(data=dat, aes(x,y)) +
ylim(c(0,129)) + xlim(c(0,129)) +
theme(aspect.ratio = 1)
p2 <- ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[(i-19):i,], aes(x=abs(angle), y=speed), col="red")+
geom_point(data=d[i,], aes(x=abs(angle), y=speed), col="red", size=2)
gridExtra
library(gridExtra)
grid.arrange(p1, p2, nrow = 1)
p1 <- ggplot(d[(i-19):i,], aes(x=x, y=y)) + geom_path(col="red") +
geom_point(data=d[i,],aes(x,y),size=2, col="red")
geom_path(data=dat, aes(x,y)) +
ylim(c(0,129)) + xlim(c(0,129)) +
theme(aspect.ratio = 1)
p1 <- ggplot(d[(i-19):i,], aes(x=x, y=y)) + geom_path(col="red") +
geom_point(data=d[i,],aes(x,y),size=2, col="red") +
geom_path(data=dat, aes(x,y)) +
ylim(c(0,129)) + xlim(c(0,129)) +
theme(aspect.ratio = 1)
p2 <- ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[(i-19):i,], aes(x=abs(angle), y=speed), col="red")+
geom_point(data=d[i,], aes(x=abs(angle), y=speed), col="red", size=2)
grid.arrange(p1, p2, nrow = 1)
d$spdiff <- c(diff(d$speed),NA)
p3 <- ggplot(Res, aes(x=sp, y=spchange)) +
stat_bin2d(bins=c(60,60)) +
theme(aspect.ratio = 1)+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[(i-19):i,], aes(x=speed, y=spdiff), col="red")+
geom_point(data=d[i,], aes(x=speed, y=spdiff), col="red", size=2)
p3
grid.arrange(p1, p2, p3, nrow = 1)
grid.arrange(p1, p2, p3, nrow = 2)
grid.arrange(p1, p2, p3, nrow = 1)
p2 <- ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1, legend.position = "none")+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[(i-19):i,], aes(x=abs(angle), y=speed), col="red")+
geom_point(data=d[i,], aes(x=abs(angle), y=speed), col="red", size=2)
p3 <- ggplot(Res, aes(x=sp, y=spchange)) +
stat_bin2d(bins=c(60,60)) +
theme(aspect.ratio = 1, legend.position = "none")+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[(i-19):i,], aes(x=speed, y=spdiff), col="red")+
geom_point(data=d[i,], aes(x=speed, y=spdiff), col="red", size=2)
grid.arrange(p1, p2, p3, nrow = 1)
for(i in 20:dim(d)[1]){
p1 <- ggplot(d[(i-19):i,], aes(x=x, y=y)) + geom_path(col="red") +
geom_point(data=d[i,],aes(x,y),size=2, col="red") +
geom_path(data=dat, aes(x,y)) +
ylim(c(0,129)) + xlim(c(0,129)) +
theme(aspect.ratio = 1)
p2 <- ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1, legend.position = "none")+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[(i-19):i,], aes(x=abs(angle), y=speed), col="red")+
geom_point(data=d[i,], aes(x=abs(angle), y=speed), col="red", size=2)
p3 <- ggplot(Res, aes(x=sp, y=spchange)) +
stat_bin2d(bins=c(60,60)) +
theme(aspect.ratio = 1, legend.position = "none")+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[(i-19):i,], aes(x=speed, y=spdiff), col="red")+
geom_point(data=d[i,], aes(x=speed, y=spdiff), col="red", size=2)
grid.arrange(p1, p2, p3, nrow = 1)
ggsave(paste0("E:\\",formatC(i,width=5,flag="0"), ".png"))
}
grid.arrange(p1, p2, p3, nrow = 1)
for(i in 20:dim(d)[1]){
p1 <- ggplot(d[(i-19):i,], aes(x=x, y=y)) + geom_path(col="red") +
geom_point(data=d[i,],aes(x,y),size=2, col="red") +
geom_path(data=dat, aes(x,y)) +
ylim(c(0,129)) + xlim(c(0,129)) +
theme(aspect.ratio = 1)
p2 <- ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1, legend.position = "none")+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[(i-19):i,], aes(x=abs(angle), y=speed), col="red")+
geom_point(data=d[i,], aes(x=abs(angle), y=speed), col="red", size=2)
p3 <- ggplot(Res, aes(x=sp, y=spchange)) +
stat_bin2d(bins=c(60,60)) +
theme(aspect.ratio = 1, legend.position = "none")+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[(i-19):i,], aes(x=speed, y=spdiff), col="red")+
geom_point(data=d[i,], aes(x=speed, y=spdiff), col="red", size=2)
png(paste0("E:\\",formatC(i,width=5,flag="0"), ".png"))
grid.arrange(p1, p2, p3, nrow = 1)
dev.off()
#ggsave(paste0("E:\\",formatC(i,width=5,flag="0"), ".png"))
}
png(paste0("E:\\",formatC(i,width=5,flag="0"), ".png"), width=20)
grid.arrange(p1, p2, p3, nrow = 1)
dev.off()
png(paste0("E:\\",formatC(i,width=5,flag="0"), ".png"), width=200)
grid.arrange(p1, p2, p3, nrow = 1)
dev.off()
png(paste0("E:\\",formatC(i,width=5,flag="0"), ".png"), width=2000)
grid.arrange(p1, p2, p3, nrow = 1)
dev.off()
png(paste0("E:\\",formatC(i,width=5,flag="0"), ".png"), width=2000, height=1000)
grid.arrange(p1, p2, p3, nrow = 1)
dev.off()
for(i in 20:dim(d)[1]){
p1 <- ggplot(d[(i-19):i,], aes(x=x, y=y)) + geom_path(col="red") +
geom_point(data=d[i,],aes(x,y),size=2, col="red") +
geom_path(data=dat, aes(x,y)) +
ylim(c(0,129)) + xlim(c(0,129)) +
theme(aspect.ratio = 1)
p2 <- ggplot(Res, aes(x=abs(angle), y=sp)) +
stat_bin2d(bins=c(100,100)) +
theme(aspect.ratio = 1, legend.position = "none")+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[(i-19):i,], aes(x=abs(angle), y=speed), col="red")+
geom_point(data=d[i,], aes(x=abs(angle), y=speed), col="red", size=2)
p3 <- ggplot(Res, aes(x=sp, y=spchange)) +
stat_bin2d(bins=c(60,60)) +
theme(aspect.ratio = 1, legend.position = "none")+
scale_fill_viridis(trans = 'log10')+
geom_path(data=d[(i-19):i,], aes(x=speed, y=spdiff), col="red")+
geom_point(data=d[i,], aes(x=speed, y=spdiff), col="red", size=2)
png(paste0("E:\\",formatC(i,width=5,flag="0"), ".png"), width=2000, height=1000)
grid.arrange(p1, p2, p3, nrow = 1)
dev.off()
#ggsave(paste0("E:\\",formatC(i,width=5,flag="0"), ".png"))
}
